<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal des Curieux - Actualit√©s</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Lexend:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/curio-main.css">
    <link rel="stylesheet" href="styles/dashboard-home.css">
    
    <style>
        /* === BOUTON RETOUR MINECRAFT STYLIS√â === */
        .btn-back-minecraft {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(135deg, #1d3557 0%, #457b9d 100%);
            color: white;
            border: 3px solid #a8dadc;
            padding: 0.75rem 1.5rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3),
                        inset 0 -3px 0 rgba(0,0,0,0.2),
                        inset 0 3px 0 rgba(255,255,255,0.2);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            text-decoration: none;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }
        
        .btn-back-minecraft::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn-back-minecraft:hover {
            background: linear-gradient(135deg, #457b9d 0%, #1d3557 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.4),
                        inset 0 -3px 0 rgba(0,0,0,0.2),
                        inset 0 3px 0 rgba(255,255,255,0.3);
            border-color: #f1faee;
        }
        
        .btn-back-minecraft:hover::before {
            left: 100%;
        }
        
        .btn-back-minecraft:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.3),
                        inset 0 2px 4px rgba(0,0,0,0.3);
        }
        
        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .btn-back-minecraft {
                font-size: 0.65rem;
                padding: 0.6rem 1.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .btn-back-minecraft {
                font-size: 0.55rem;
                padding: 0.5rem 1rem;
            }
        }
    </style>
</head>
<body class="dashboard-home">
    <div class="container">
        <nav class="quick-nav" style="display: flex; padding: 1.5rem 1rem; margin-bottom: 20px;">
            <a href="index-dashboard.html" class="btn-back-minecraft">‚Üê RETOUR AU DASHBOARD</a>
        </nav>

        <header class="main-header">
            <div class="logo-section">
                <h1 class="main-title">üóûÔ∏è LE JOURNAL DES CURIEUX</h1>
                <p id="exp-status" class="pixel-font" style="color: #ffcc00; font-size: 0.7em; margin-top: 10px;">CHARGEMENT DE TES POINTS...</p>
            </div>
            <button id="btn-refresh-news" class="btn-curio" style="background: #f39c12; font-size: 0.5em;">ACTUALISER LE JOURNAL</button>
        </header>

        <div id="news-container" class="sections-grid" style="display: block;">
            </div>

        <section class="section-card" style="margin-top: 30px; width: 100%; border-left: 8px solid #005a8a;">
            <div class="section-header">
                <span class="section-emoji">üìú</span>
                <h2 class="section-title">Informations G√©n√©rales</h2>
            </div>
            <div class="section-description">
                <p>Bienvenue dans l'espace d'Instruction en Famille (IEF). Chaque activit√© ici est con√ßue pour respecter les attendus du <strong>Socle Commun</strong>.</p>
                <p style="margin-top: 10px;"><em>"Apprendre est la plus grande des aventures."</em></p>
            </div>
        </section>

        <footer class="dashboard-footer">
            <p>Le Monde des Curieux ¬© 2026 - Plateforme √âducative</p>
        </footer>
    </div>

    <script>
        // ON GARDE EXACTEMENT TA LOGIQUE DE DONN√âES
        const NEWS_FILE = 'data/news.json';
        const STORAGE_KEY_EXP = 'curio_total_exp';
        const STORAGE_KEY_QUESTS = 'curio_quetes_terminees';

        function rafraichirAffichageEXP() {
            const totalExp = localStorage.getItem(STORAGE_KEY_EXP) || 0;
            document.getElementById('exp-status').innerText = `‚≠ê TOTAL EXP : ${totalExp}`;
        }

        window.validerQuete = function(idQuete) {
            let quetesTerminees = JSON.parse(localStorage.getItem(STORAGE_KEY_QUESTS) || '[]');
            if (!quetesTerminees.includes(idQuete)) {
                quetesTerminees.push(idQuete);
                localStorage.setItem(STORAGE_KEY_QUESTS, JSON.stringify(quetesTerminees));
                let actuelEXP = parseInt(localStorage.getItem(STORAGE_KEY_EXP) || 0);
                localStorage.setItem(STORAGE_KEY_EXP, actuelEXP + 10);
                alert("‚ú® Succ√®s ! +10 EXP ajout√©s √† ton profil.");
                rafraichirAffichageEXP();
                chargerJournal();
            }
        };

        async function chargerJournal() {
            const container = document.getElementById('news-container');
            try {
                const response = await fetch(`${NEWS_FILE}?v=${Date.now()}`);
                const data = await response.json();
                const articles = data.articles || [];
                const quetesFaites = JSON.parse(localStorage.getItem(STORAGE_KEY_QUESTS) || '[]');

                // On transforme tes actualit√©s JSON en cartes Minecraft
                container.innerHTML = articles.map((a, index) => {
                    const idUnique = `quest-${index}-${a.title.substring(0,5)}`;
                    const dejaFait = quetesFaites.includes(idUnique);

                    return `
                        <article class="section-card" style="margin-bottom: 20px; width: 100%; ${dejaFait ? 'opacity: 0.7; border-color: #55FF55;' : ''}">
                            <div class="section-header">
                                <span class="section-emoji">${dejaFait ? '‚úÖ' : 'üìú'}</span>
                                <h2 class="section-title" style="font-size: 0.8em; color: #2c3e50;">${a.title}</h2>
                                <span style="font-size: 0.6em; margin-left: auto;">${a.date || ''}</span>
                            </div>
                            <div class="section-description" style="font-family: 'Lexend', sans-serif; color: #333;">
                                ${a.summary}
                            </div>
                            <div style="text-align: right; margin-top: 15px;">
                                ${!dejaFait 
                                    ? `<button class="btn-curio" style="background: #2a9d8f; font-size: 0.5em;" onclick="validerQuete('${idUnique}')">R√âCLAMER +10 EXP</button>`
                                    : `<span style="color: #00aa00; font-family: 'Press Start 2P'; font-size: 0.5em;">COMPL√âT√â</span>`
                                }
                            </div>
                        </article>
                    `;
                }).join('');
                rafraichirAffichageEXP();
            } catch (e) { 
                container.innerHTML = "<p style='color:white;'>Impossible de lire le journal des actualit√©s.</p>"; 
            }
        }

        document.getElementById('btn-refresh-news').onclick = chargerJournal;
        window.onload = chargerJournal;
    </script>
</body>
</html>
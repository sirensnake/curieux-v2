<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Monde des Curieux - Accueil</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/home-page.css">
    <link rel="stylesheet" href="styles/side-menu-unified.css">
    <link rel="stylesheet" href="styles/mindmap_svg.css">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script src="scripts/mission-histoire.js"></script>
    <script src="scripts/mission-robots.js"></script>
    <script src="scripts/mission-sciences.js"></script>
    <script src="scripts/mission-francais.js"></script>
    <script src="scripts/mission-english.js"></script>
    <script src="scripts/mission-math.js"></script>
    
    <script src="scripts/progression.js"></script>
    <script src="scripts/mission-engine.js"></script>

    <style>
        .menu-toggle-btn { position: fixed; top: 15px; left: 15px; z-index: 1100; }
        .header-content { display: flex; justify-content: space-between; align-items: center; width: 100%; gap: 20px; padding-left: 70px; }
        .user-info { display: flex; align-items: center; gap: 12px; cursor: pointer; background: rgba(255, 255, 255, 0.2); padding: 5px 12px 5px 5px; border-radius: 10px; border: 2px solid rgba(0, 0, 0, 0.1); }
        .avatar-container { width: 44px; height: 44px; border: 2px solid #2c3e50; background: #fff; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .user-avatar-img { width: 100%; height: 100%; object-fit: cover; image-rendering: pixelated; }
        .xp-badge { background: #f1c40f; color: #2c3e50; padding: 4px 10px; border-radius: 6px; font-size: 11px; font-family: 'Press Start 2P'; border-bottom: 3px solid #d4ac0d; }
        .stats-btn { font-family: 'Press Start 2P', cursive; font-size: 10px; padding: 10px; background: #2a9d8f; color: white; border: 3px solid #2c3e50; cursor: pointer; }
    </style>
</head>
<body class="home-page">

    <button class="menu-toggle-btn" onclick="toggleSideMenu()">â˜°</button>

    <header class="main-header">
        <div class="header-content">
            <div class="user-info" onclick="window.location.href='select-avatar.html'">
                <div class="avatar-container">
                    <img src="assets/img/avatars/default.png" class="user-avatar-img" id="header-avatar">
                </div>
                <div class="user-stats">
                    <span id="xp-display" class="xp-badge">0 XP</span>
                </div>
            </div>
            
            <div class="header-text">
                <h1 style="font-size: 18px; margin: 0;">ðŸŽ® Le Monde des Curieux</h1>
            </div>

            <div style="display: flex; gap: 10px;">
                <button class="stats-btn" onclick="window.location.href='dashboard-analytics.html'">ðŸ“Š Stats</button>
                <button class="stats-btn" onclick="window.location.href='admin-stats.html'">ðŸ“Š Rapport</button>
            </div>
        </div>
    </header>

    <main class="game-container">
        <section class="map-section">
            <div class="mindmap-container">
                <svg viewBox="0 0 1024 1024" class="mindmap-svg">
                    <image href="images/mindmap_lemondedescurieux_v2.png" width="1024" height="1024"/>
                    
                    <a href="francais_duolingo_section.html"><circle class="zone-clickable" cx="209" cy="270" r="85"></circle></a>
                    <a href="maths_duolingo_section.html"><circle class="zone-clickable" cx="809" cy="271" r="85"></circle></a>
                    <a href="histoire_duolingo_section.html"><circle class="zone-clickable" cx="125" cy="491" r="85"></circle></a>
                    <a href="english_duolingo_section.html"><circle class="zone-clickable" cx="900" cy="490" r="85"></circle></a>
                    <a href="sciences_duolingo_section.html"><circle class="zone-clickable" cx="182" cy="724" r="80"></circle></a>
                    
                    <a href="ressources_section.html"><circle class="zone-clickable" cx="843" cy="724" r="85"></circle></a>
                    <a href="infos_section.html"><circle class="zone-clickable" cx="641" cy="846" r="80"></circle></a>
                    <a href="index-dashboard.html"><circle class="zone-clickable" cx="392" cy="844" r="75"></circle></a>
                </svg>
            </div>
        </section>

        <aside class="sidebar-section">
            <div class="card">
                <h2>ðŸš€ Missions SpÃ©ciales</h2>
                <div class="mission-list">
                    <div class="mission-item">ðŸ“š FranÃ§ais <button id="btn-mission-francais" onclick="launchMission(missionFrancais)" class="play-btn">Jouer</button></div>
                    <div class="mission-item">ðŸ”¢ Maths <button id="btn-mission-maths" onclick="launchMission(missionMaths)" class="play-btn">Jouer</button></div>
                    <div class="mission-item">ðŸ‡¬ðŸ‡§ English <button id="btn-mission-english" onclick="launchMission(missionEnglish)" class="play-btn">Jouer</button></div>
                    <div class="mission-item">ðŸ‘‘ Histoire <button id="btn-mission-histoire" onclick="launchMission(missionHistoire)" class="play-btn">Jouer</button></div>
                    <div class="mission-item">ðŸ§ª Sciences <button id="btn-mission-sciences" onclick="launchMission(missionSciences)" class="play-btn">Jouer</button></div>
                    <div class="mission-item">ðŸ¤– Robots <button  id="btn-mission-robots"onclick="launchMission(missionRobots)" class="play-btn">Jouer</button></div>
                </div>
                <button onclick="resetProgression()" class="reset-btn" style="margin-top:15px;">RÃ‰INITIALISER</button>
            </div>
        </aside>
    </main>

    <div id="side-menu-container"></div>

    <script>
        const curioAvatars = [
            { id: 'curio_1', name: 'Explorateur', img: 'assets/img/avatars/explorer.png' },
            { id: 'curio_2', name: 'Scientifique', img: 'assets/img/avatars/scholar.png' },
            { id: 'curio_3', name: 'MaÃ®tre Goupil', img: 'assets/img/avatars/fox.png' }
        ];
    </script>
    <script src="scripts/modules/reporting.js"></script>
    <script src="scripts/core/profile-manager.js"></script>
    <script src="scripts/side-menu-unified.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const xp = localStorage.getItem('curio_xp') || 0;
            document.getElementById('xp-display').innerText = xp + " XP";
            if (window.profileManager) window.profileManager.updateAvatarDisplay();
            if (typeof loadSideMenu === "function") loadSideMenu();
        });

        function resetProgression() {
            if(confirm("Effacer ta progression ?")) { localStorage.clear(); location.reload(); }
        }
    </script>
</body>
</html>